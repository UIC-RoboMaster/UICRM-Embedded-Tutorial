# 按键中断

[English](README.md) | [中文](README_zh.md)

## 什么是中断

在嵌入式系统中，我们经常需要响应外部事件。例如，当按下按钮时，我们需要点亮 LED。在这种情况下，我们需要在主循环中不断读取按钮状态。这被称为轮询。但是，这种方法并不高效。我们可以使用中断来解决这个问题。

中断是一种机制，它允许 CPU 及时响应外部事件。当发生外部事件时，CPU 将停止当前任务并执行相应的中断服务例程。执行中断服务例程后，CPU 将返回原始任务。

因此，我们可以使用中断来响应外部事件。例如，当按下按钮时，我们可以使用中断来点亮 LED。

但是，中断服务例程中的程序应尽可能简单。这是因为当发生中断时，CPU 将停止当前任务。如果中断服务例程太长，CPU 将花费太多时间在中断服务例程上，主任务将无法及时执行。这将导致系统崩溃。

## 中断的优先级

在 STM32F103C8T6 中，有 16 个中断。中断的优先级从 0 到 15。数字越小，优先级越高。优先级最高的中断是复位中断。优先级最低的中断是滴答中断（系统计时器）。
优先级较高的中断可以中断优先级较低的中断。例如，如果滴答中断正在执行，并且按键中断发生，则按键中断将中断滴答中断。

## 错误中断

除了正常的中断外，还有错误中断。错误中断用于处理错误。例如，当堆栈溢出时，将执行错误中断。通常情况下，当发生错误中断时，系统将永远停止（错误中断服务例程中有一个 `while(1)` 循环）。因此，我们应该避免错误中断，例如堆栈溢出和内存访问错误。
